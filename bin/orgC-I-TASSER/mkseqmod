#!/usr/bin/perl
#PBS -e !ERRFILE!
#PBS -o !OUTFILE!
#PBS -l !WALLTIME!

use Math::Trig;

########### setup  the environment and Working DIRectory ###
$ENV{'PATH'}="/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin:/usr/pgi/linux86/bin";
$ENV{'LD_LIBRARY_PATH'}="/usr/local/lib:/usr/lib:/lib";

##### report node -------->
`hostname`=~/(\S+)/;
$node=$1;
printf "hostname: $node\n";
$time=`date`;
printf "starting time: $time";
$pwd=`pwd`;
printf "pwd: $pwd";
#^^^^^^^^^^^^^^^^^^^^^^^^^^

$tmpdir="/tmp/!USER!/!TAG!";
$datadir="!DATADIR!";
$librarydir="!LIBRARYDIR!";

######### psipred ################
$psipreddir="$librarydir/bin/psipred";
system("$psipreddir/runpsipred.pl $tmpdir $datadir seq.txt seq.psi");

######### PSSpred ################
$PSSpreddir="$librarydir/bin/PSSpred";
system("$PSSpreddir/runPSSpred.pl $tmpdir $datadir seq.txt seq.pss exp.dat");

######### combine PSIpred and PSSpred into 'seq.dat'---------->
system("/nfs/amino-library/bin/combine_SS.pl $datadir seq.psi.ss seq.pss.ss seq.dat");

################# endding procedure ######################
$time=`date`;
printf "ending time: $time";

exit();

